<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Comparison To Historical Data &mdash; PyPSA-GB  documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Network Expansion" href="7%20-%20Network%20Expansion.html" />
    <link rel="prev" title="Unit Commitment" href="6%20-%20Unit%20Commitment.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> PyPSA-GB
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Data and Functionality</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1%20-%20Network.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="2%20-%20Demand.html">Demand</a></li>
<li class="toctree-l1"><a class="reference internal" href="3%20-%20Generator%20and%20Marginal%20Prices.html">Generator and Marginal Prices</a></li>
<li class="toctree-l1"><a class="reference internal" href="4%20-%20Renewable%20Power%20and%20Storage.html">Renewable Power and Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="5a%20-%20LOPF%20Historical.html">Historical Network Constrained Linear Optimal Power Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="5b%20-%20LOPF%20Future.html">Future Network Constrained Linear Optimal Power Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="6%20-%20Unit%20Commitment.html">Unit Commitment</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Comparison To Historical Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Setting-up-simulation">Setting up simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Running-the-optimisation">Running the optimisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Power-output-by-generation-type">Power output by generation type</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Simulated-vs-historical-data-power-generation">Simulated vs historical data power generation</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="7%20-%20Network%20Expansion.html">Network Expansion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seasonal_thermal_energy_storage.html">Seasonal Thermal Energy Storage</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../API_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyPSA-GB</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Comparison To Historical Data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/9 - Comparison To Historical Data.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Comparison-To-Historical-Data">
<h1>Comparison To Historical Data<a class="headerlink" href="#Comparison-To-Historical-Data" title="Permalink to this headline">¶</a></h1>
<p>PyPSA-GB can model the GB power system by solving a network constrained Linear Optimal Power Flow (LOPF) problem. This notebook shows the example application of a historical 3 day period.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pypsa</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>

<span class="kn">import</span> <span class="nn">data_reader_writer</span>
</pre></div>
</div>
</div>
<div class="section" id="Setting-up-simulation">
<h2>Setting up simulation<a class="headerlink" href="#Setting-up-simulation" title="Permalink to this headline">¶</a></h2>
<p>Set the required inputs for the LOPF: the start, end and year of simulation, and the timestep.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># write csv files for import</span>
<span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;2018-01-01 00:00:00&#39;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s1">&#39;2018-12-31 23:00:00&#39;</span>
<span class="c1"># year of simulation</span>
<span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span>
<span class="c1"># time step as fraction of hour</span>
<span class="n">time_step</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<p>data_reader_writer is a script written to read in data from the various sources and write csv files in the format required for populating a PyPSA network object</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_reader_writer</span><span class="o">.</span><span class="n">data_writer</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">time_step</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">merge_generators</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\Users\alyden\Anaconda3\envs\PyPSA-GB\lib\site-packages\pandas\core\indexing.py:1667: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self.obj[key] = value
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span> <span class="o">=</span> <span class="n">pypsa</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>

<span class="n">network</span><span class="o">.</span><span class="n">import_from_csv_folder</span><span class="p">(</span><span class="s1">&#39;LOPF_data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:pypsa.io:
Importing PyPSA from older version of PyPSA than current version.
Please read the release notes at https://pypsa.readthedocs.io/en/latest/release_notes.html
carefully to prepare your network for import.
Currently used PyPSA version [0, 19, 2], imported network file PyPSA version None.

INFO:pypsa.components:Applying weightings to all columns of `snapshot_weightings`
INFO:pypsa.io:Imported network LOPF_data has buses, generators, lines, loads, storage_units
</pre></div></div>
</div>
<p>To approximate n-1 security and allow room for reactive power flows, don’t allow any line to be loaded above 70% of their thermal rating</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">contingency_factor</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">s_max_pu</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">99</span><span class="p">]</span> <span class="o">*=</span> <span class="n">contingency_factor</span>
</pre></div>
</div>
</div>
<p>LOPF does not account for losses through lines. Here we add a 10% margin to the load in order to account for these losses.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">loads_t</span><span class="o">.</span><span class="n">p_set</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">29</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">1.1</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Running-the-optimisation">
<h2>Running the optimisation<a class="headerlink" href="#Running-the-optimisation" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">lopf</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;gurobi&quot;</span><span class="p">,</span> <span class="n">pyomo</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 126.27s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Set parameter Username
Academic license - for non-commercial use only - expires 2022-09-03
Read LP format model from file C:\Users\alyden\AppData\Local\Temp\pypsa-problem-v4xz918u.lp
Reading time = 73.15 seconds
obj: 27855382 rows, 7235761 columns, 49245880 nonzeros
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (win64)
Thread count: 4 physical cores, 8 logical processors, using up to 8 threads
Optimize a model with 27855382 rows, 7235761 columns and 49245880 nonzeros
Model fingerprint: 0xbf5cf689
Coefficient statistics:
  Matrix range     [6e-05, 1e+00]
  Objective range  [1e+00, 1e+02]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e-06, 1e+04]

Concurrent LP optimizer: dual simplex and barrier
Showing barrier log only...

Presolve removed 0 rows and 0 columns (presolve time = 15s) ...
Presolve removed 26795438 rows and 43801 columns (presolve time = 19s) ...
Presolve removed 26795438 rows and 231476 columns (presolve time = 21s) ...
Presolve removed 26795438 rows and 231476 columns (presolve time = 25s) ...
Presolve removed 26795438 rows and 5372573 columns (presolve time = 45s) ...
Presolve removed 26802865 rows and 5380000 columns (presolve time = 51s) ...
Presolve removed 27307778 rows and 5884913 columns (presolve time = 69s) ...
Presolve removed 27307778 rows and 5885307 columns (presolve time = 71s) ...
Presolve removed 27307778 rows and 5902962 columns (presolve time = 75s) ...
Presolve removed 27377850 rows and 5902962 columns
Presolve time: 79.85s
Presolved: 477532 rows, 1402871 columns, 2921075 nonzeros

Ordering time: 0.33s

Barrier statistics:
 AA&#39; NZ     : 1.974e+06
 Factor NZ  : 1.191e+07 (roughly 900 MB of memory)
 Factor Ops : 5.660e+08 (less than 1 second per iteration)
 Threads    : 3

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   2.78746600e+11 -1.34225032e+12  3.64e+04 1.75e+01  2.20e+06    82s
   1   4.84865814e+10 -4.58764024e+11  5.04e+03 2.56e-13  3.56e+05    83s
   2   1.75304416e+10 -1.19868173e+11  7.76e+02 3.41e-13  6.85e+04    84s
   3   1.14862821e+10 -1.01409172e+10  3.12e+01 1.71e-12  8.13e+03    85s
   4   9.85558062e+09  2.93072933e+09  6.68e+00 5.26e-13  2.50e+03    86s
   5   9.30831116e+09  6.27088544e+09  3.10e+00 2.13e-13  1.09e+03    87s
   6   9.03318792e+09  7.26921281e+09  1.77e+00 1.23e-13  6.30e+02    88s
   7   8.85282625e+09  7.94784136e+09  9.65e-01 1.14e-13  3.22e+02    89s
   8   8.71764615e+09  8.30479040e+09  4.30e-01 1.71e-13  1.47e+02    90s
   9   8.66819671e+09  8.43158005e+09  2.50e-01 1.71e-13  8.42e+01    91s
  10   8.63166501e+09  8.52513686e+09  1.23e-01 1.71e-13  3.79e+01    92s
  11   8.61397237e+09  8.56331759e+09  6.48e-02 1.14e-13  1.80e+01    94s
  12   8.60440353e+09  8.57028876e+09  3.51e-02 1.14e-13  1.21e+01    95s
  13   8.60142667e+09  8.57816839e+09  2.57e-02 1.14e-13  8.27e+00    96s
  14   8.59923054e+09  8.58379480e+09  1.89e-02 1.14e-13  5.48e+00    96s
  15   8.59736015e+09  8.58687098e+09  1.34e-02 1.14e-13  3.73e+00    97s
  16   8.59639921e+09  8.58872020e+09  1.05e-02 1.14e-13  2.73e+00    98s
  17   8.59558316e+09  8.58982515e+09  8.06e-03 1.14e-13  2.05e+00    99s
  18   8.59490787e+09  8.59117008e+09  6.14e-03 6.98e-14  1.33e+00   100s
  19   8.59469141e+09  8.59133304e+09  5.51e-03 1.14e-13  1.19e+00   101s
  20   8.59451156e+09  8.59152545e+09  5.03e-03 1.14e-13  1.06e+00   103s
  21   8.59415033e+09  8.59196989e+09  4.01e-03 8.53e-14  7.74e-01   104s
  22   8.59352172e+09  8.59226855e+09  2.23e-03 8.21e-14  4.45e-01   105s
  23   8.59334057e+09  8.59243695e+09  1.70e-03 7.42e-14  3.21e-01   107s
  24   8.59307231e+09  8.59248704e+09  9.57e-04 1.14e-13  2.08e-01   108s
  25   8.59301349e+09  8.59254211e+09  7.76e-04 1.14e-13  1.67e-01   109s
  26   8.59298534e+09  8.59260573e+09  6.88e-04 6.82e-14  1.35e-01   110s
  27   8.59296241e+09  8.59261896e+09  6.18e-04 6.53e-14  1.22e-01   111s
  28   8.59293736e+09  8.59263103e+09  5.40e-04 7.73e-14  1.09e-01   112s
  29   8.59286623e+09  8.59268250e+09  3.32e-04 7.78e-14  6.52e-02   113s
  30   8.59281233e+09  8.59272641e+09  1.61e-04 8.06e-14  3.05e-02   114s
  31   8.59278026e+09  8.59274572e+09  6.03e-05 6.72e-14  1.23e-02   115s
  32   8.59276434e+09  8.59275391e+09  1.13e-05 8.11e-14  3.71e-03   116s
  33   8.59276162e+09  8.59275950e+09  3.42e-06 8.85e-14  7.52e-04   117s
  34   8.59276066e+09  8.59276013e+09  8.27e-07 1.01e-11  1.88e-04   118s
  35   8.59276048e+09  8.59276040e+09  1.72e-06 3.24e-12  3.06e-05   119s
  36   8.59276046e+09  8.59276045e+09  1.48e-07 1.14e-12  3.69e-06   120s
  37   8.59276046e+09  8.59276046e+09  3.33e-08 9.96e-14  1.77e-08   121s
  38   8.59276046e+09  8.59276046e+09  4.66e-10 7.18e-14  8.64e-13   122s

Barrier solved model in 38 iterations and 121.90 seconds (46.90 work units)
Optimal objective 8.59276046e+09

Crossover log...

   66085 DPushes remaining with DInf 0.0000000e+00               125s
     822 DPushes remaining with DInf 0.0000000e+00               126s
       0 DPushes remaining with DInf 0.0000000e+00               127s

  160827 PPushes remaining with PInf 0.0000000e+00               127s
   64171 PPushes remaining with PInf 0.0000000e+00               131s
   43780 PPushes remaining with PInf 0.0000000e+00               136s
   36718 PPushes remaining with PInf 0.0000000e+00               140s
   23893 PPushes remaining with PInf 0.0000000e+00               147s
   17989 PPushes remaining with PInf 0.0000000e+00               150s
    4201 PPushes remaining with PInf 0.0000000e+00               158s
    2937 PPushes remaining with PInf 0.0000000e+00               160s
       0 PPushes remaining with PInf 0.0000000e+00               164s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4542101e-09    164s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  188622    8.5927605e+09   0.000000e+00   0.000000e+00    203s

Solved with barrier
Solved in 188622 iterations and 202.82 seconds (85.09 work units)
Optimal objective  8.592760455e+09
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:pypsa.linopf:Optimization successful. Objective value: 8.59e+09
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;ok&#39;, &#39;optimal&#39;)
</pre></div></div>
</div>
</div>
<div class="section" id="Power-output-by-generation-type">
<h2>Power output by generation type<a class="headerlink" href="#Power-output-by-generation-type" title="Permalink to this headline">¶</a></h2>
<p>Group the generators by the carrier, and print their summed power outputs over the simulation period.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_by_carrier</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
    <span class="n">network</span><span class="o">.</span><span class="n">generators</span><span class="o">.</span><span class="n">carrier</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">storage_by_carrier</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">storage_units_t</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
    <span class="n">network</span><span class="o">.</span><span class="n">storage_units</span><span class="o">.</span><span class="n">carrier</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># to show on graph set the negative storage values to zero</span>
<span class="n">storage_by_carrier</span><span class="p">[</span><span class="n">storage_by_carrier</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">p_by_carrier</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">p_by_carrier</span><span class="p">,</span> <span class="n">storage_by_carrier</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># interconnector exports</span>
<span class="n">exports</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">loads_t</span><span class="o">.</span><span class="n">p</span>
<span class="c1"># multiply by negative one to convert it as a generator</span>
<span class="c1"># i.e. export is a positive load, but negative generator</span>
<span class="n">exports</span><span class="p">[</span><span class="s1">&#39;Interconnectors Export&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exports</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">6</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">interconnector_export</span> <span class="o">=</span> <span class="n">exports</span><span class="p">[[</span><span class="s1">&#39;Interconnectors Export&#39;</span><span class="p">]]</span>

<span class="c1"># group biomass stuff</span>
<span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Biomass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Biomass (dedicated)&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Biomass (co-firing)&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Landfill Gas&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Anaerobic Digestion&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Sewage Sludge Digestion&#39;</span><span class="p">])</span>

<span class="c1"># rename the hydro bit</span>
<span class="n">p_by_carrier</span> <span class="o">=</span> <span class="n">p_by_carrier</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Large Hydro&#39;</span><span class="p">:</span> <span class="s1">&#39;Hydro&#39;</span><span class="p">})</span>
<span class="n">p_by_carrier</span> <span class="o">=</span> <span class="n">p_by_carrier</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Interconnector&#39;</span><span class="p">:</span> <span class="s1">&#39;Interconnectors Import&#39;</span><span class="p">})</span>

<span class="o">%</span><span class="k">store</span> p_by_carrier
<span class="n">p_by_carrier</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Stored &#39;p_by_carrier&#39; (DataFrame)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>carrier</th>
      <th>Anaerobic Digestion</th>
      <th>Biomass (co-firing)</th>
      <th>Biomass (dedicated)</th>
      <th>Coal</th>
      <th>EfW Incineration</th>
      <th>Interconnectors Import</th>
      <th>Landfill Gas</th>
      <th>Hydro</th>
      <th>Natural Gas</th>
      <th>Nuclear</th>
      <th>Oil</th>
      <th>Sewage Sludge Digestion</th>
      <th>Shoreline Wave</th>
      <th>Small Hydro</th>
      <th>Solar Photovoltaics</th>
      <th>Tidal Barrage and Tidal Stream</th>
      <th>Wind Offshore</th>
      <th>Wind Onshore</th>
      <th>Pumped Storage Hydroelectric</th>
      <th>Biomass</th>
    </tr>
    <tr>
      <th>snapshot</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-01-01 00:00:00</th>
      <td>315.200000</td>
      <td>0.00</td>
      <td>19.929</td>
      <td>531.542604</td>
      <td>396.576</td>
      <td>3163.499962</td>
      <td>743.5</td>
      <td>312.435669</td>
      <td>8408.289321</td>
      <td>6833.530000</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>24.0</td>
      <td>40.564332</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>5322.763752</td>
      <td>6499.869773</td>
      <td>0.000000</td>
      <td>1128.829000</td>
    </tr>
    <tr>
      <th>2018-01-01 01:00:00</th>
      <td>315.200000</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000</td>
      <td>396.576</td>
      <td>2756.500024</td>
      <td>743.5</td>
      <td>308.010233</td>
      <td>9723.029280</td>
      <td>6833.530000</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>24.0</td>
      <td>39.989766</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>5318.656864</td>
      <td>6233.178739</td>
      <td>24.029040</td>
      <td>1108.900000</td>
    </tr>
    <tr>
      <th>2018-01-01 02:00:00</th>
      <td>315.200000</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000</td>
      <td>396.576</td>
      <td>2771.499986</td>
      <td>743.5</td>
      <td>293.406300</td>
      <td>10007.058937</td>
      <td>6833.530000</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>24.0</td>
      <td>38.093700</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>5315.245105</td>
      <td>6067.016448</td>
      <td>67.273469</td>
      <td>1108.900000</td>
    </tr>
    <tr>
      <th>2018-01-01 03:00:00</th>
      <td>315.200000</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000</td>
      <td>396.576</td>
      <td>2626.499986</td>
      <td>743.5</td>
      <td>247.824325</td>
      <td>9154.443621</td>
      <td>6833.530000</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>24.0</td>
      <td>32.175674</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>5312.001825</td>
      <td>5988.198334</td>
      <td>0.000000</td>
      <td>1108.900000</td>
    </tr>
    <tr>
      <th>2018-01-01 04:00:00</th>
      <td>315.200000</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000</td>
      <td>396.576</td>
      <td>2625.499957</td>
      <td>743.5</td>
      <td>240.743629</td>
      <td>8229.633167</td>
      <td>6833.530000</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>24.0</td>
      <td>31.256368</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>5306.942938</td>
      <td>5794.067603</td>
      <td>0.000000</td>
      <td>1108.900000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2018-12-31 19:00:00</th>
      <td>311.700000</td>
      <td>509.54</td>
      <td>2272.563</td>
      <td>1961.000000</td>
      <td>396.576</td>
      <td>3055.999925</td>
      <td>734.8</td>
      <td>228.226867</td>
      <td>15647.362909</td>
      <td>6270.701406</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>23.0</td>
      <td>29.925967</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4056.750335</td>
      <td>7740.773294</td>
      <td>543.480018</td>
      <td>3878.803000</td>
    </tr>
    <tr>
      <th>2018-12-31 20:00:00</th>
      <td>303.500000</td>
      <td>509.54</td>
      <td>2272.563</td>
      <td>1961.000000</td>
      <td>396.576</td>
      <td>2717.000034</td>
      <td>708.7</td>
      <td>166.189638</td>
      <td>13223.028345</td>
      <td>6238.481406</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>23.0</td>
      <td>22.203657</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4415.811929</td>
      <td>7742.706223</td>
      <td>0.000000</td>
      <td>3844.503000</td>
    </tr>
    <tr>
      <th>2018-12-31 21:00:00</th>
      <td>303.500000</td>
      <td>509.54</td>
      <td>2272.563</td>
      <td>1961.000000</td>
      <td>396.576</td>
      <td>2714.000037</td>
      <td>708.7</td>
      <td>163.239527</td>
      <td>9875.306770</td>
      <td>6206.261406</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>23.0</td>
      <td>21.809509</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4823.838473</td>
      <td>7626.915196</td>
      <td>0.000000</td>
      <td>3844.503000</td>
    </tr>
    <tr>
      <th>2018-12-31 22:00:00</th>
      <td>310.212381</td>
      <td>509.54</td>
      <td>2272.563</td>
      <td>1961.000000</td>
      <td>396.576</td>
      <td>2774.000030</td>
      <td>722.8</td>
      <td>159.502717</td>
      <td>6799.600091</td>
      <td>6174.041406</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>23.0</td>
      <td>20.791546</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5143.001169</td>
      <td>7434.171470</td>
      <td>0.000000</td>
      <td>3865.315381</td>
    </tr>
    <tr>
      <th>2018-12-31 23:00:00</th>
      <td>309.222371</td>
      <td>509.54</td>
      <td>2272.563</td>
      <td>1961.000000</td>
      <td>396.576</td>
      <td>1182.000015</td>
      <td>730.8</td>
      <td>168.353054</td>
      <td>6885.170291</td>
      <td>6141.821406</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>23.0</td>
      <td>28.880077</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5137.163231</td>
      <td>7314.210489</td>
      <td>0.000000</td>
      <td>3872.325371</td>
    </tr>
  </tbody>
</table>
<p>8760 rows × 20 columns</p>
</div></div>
</div>
<p>Graph the power output of the different generation types…</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Nuclear&quot;</span><span class="p">,</span> <span class="s1">&#39;Shoreline Wave&#39;</span><span class="p">,</span> <span class="s1">&#39;Biomass&#39;</span><span class="p">,</span>
        <span class="s1">&#39;EfW Incineration&#39;</span><span class="p">,</span>
        <span class="s2">&quot;Coal&quot;</span><span class="p">,</span> <span class="s2">&quot;Oil&quot;</span><span class="p">,</span> <span class="s2">&quot;Natural Gas&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Pumped Storage Hydroelectric&quot;</span><span class="p">,</span> <span class="s1">&#39;Hydro&#39;</span><span class="p">,</span>
        <span class="s2">&quot;Wind Offshore&quot;</span><span class="p">,</span> <span class="s1">&#39;Wind Onshore&#39;</span><span class="p">,</span> <span class="s1">&#39;Solar Photovoltaics&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Interconnectors Import&#39;</span>
        <span class="p">]</span>

<span class="n">p_by_carrier</span> <span class="o">=</span> <span class="n">p_by_carrier</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>

<span class="n">p_by_carrier</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
    <span class="p">(</span><span class="n">p_by_carrier</span><span class="o">.</span><span class="n">max</span><span class="p">()[</span><span class="n">p_by_carrier</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">50.0</span><span class="p">])</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Coal&quot;</span><span class="p">:</span> <span class="s2">&quot;grey&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Diesel/Gas oil&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Diesel/gas Diesel/Gas oil&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
          <span class="s1">&#39;Oil&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Anaerobic Digestion&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;EfW Incineration&#39;</span><span class="p">:</span> <span class="s1">&#39;chocolate&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Sewage Sludge Digestion&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Landfill Gas&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Biomass (dedicated)&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Biomass (co-firing)&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Biomass&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Interconnectors Import&#39;</span><span class="p">:</span> <span class="s1">&#39;pink&#39;</span><span class="p">,</span>
          <span class="s2">&quot;Sour gas&quot;</span><span class="p">:</span> <span class="s2">&quot;lightcoral&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Natural Gas&quot;</span><span class="p">:</span> <span class="s2">&quot;lightcoral&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Nuclear&quot;</span><span class="p">:</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
          <span class="s1">&#39;Shoreline Wave&#39;</span><span class="p">:</span> <span class="s1">&#39;aqua&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Tidal Barrage and Tidal Stream&#39;</span><span class="p">:</span> <span class="s1">&#39;aqua&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Hydro&#39;</span><span class="p">:</span> <span class="s2">&quot;turquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Large Hydro&quot;</span><span class="p">:</span> <span class="s2">&quot;turquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Small Hydro&quot;</span><span class="p">:</span> <span class="s2">&quot;turquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Pumped Storage Hydroelectric&quot;</span><span class="p">:</span> <span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Wind Offshore&quot;</span><span class="p">:</span> <span class="s2">&quot;lightskyblue&quot;</span><span class="p">,</span>
          <span class="s1">&#39;Wind Onshore&#39;</span><span class="p">:</span> <span class="s1">&#39;deepskyblue&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Solar Photovoltaics&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="p">(</span><span class="n">p_by_carrier</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;area&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">p_by_carrier</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>

<span class="c1"># stacked area plot of negative values, prepend column names with &#39;_&#39; such that they don&#39;t appear in the legend</span>
<span class="p">(</span><span class="n">interconnector_export</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="c1"># rescale the y axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([(</span><span class="n">interconnector_export</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="p">(</span><span class="n">p_by_carrier</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>

<span class="c1"># Shrink current axis&#39;s height by 10% on the bottom</span>
<span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                 <span class="n">box</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">])</span>

<span class="c1"># Put a legend below current axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">),</span>
          <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;GW&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\Users\alyden\Anaconda3\envs\PyPSA-GB\lib\site-packages\pandas\plotting\_matplotlib\core.py:1391: UserWarning: Attempting to set identical bottom == top == 0.0 results in singular transformations; automatically expanding.
  ax.set_ylim(None, 0)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_9_-_Comparison_To_Historical_Data_19_2.png" src="../_images/notebooks_9_-_Comparison_To_Historical_Data_19_2.png" />
</div>
</div>
</div>
<div class="section" id="Simulated-vs-historical-data-power-generation">
<h2>Simulated vs historical data power generation<a class="headerlink" href="#Simulated-vs-historical-data-power-generation" title="Permalink to this headline">¶</a></h2>
<p>We can group the generators by type and sum to calculate the total simulated power generation over the year in TWh.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">store</span> -r p_by_carrier

<span class="n">p_by_carrier</span> <span class="o">=</span> <span class="n">p_by_carrier</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000000</span>
<span class="c1"># print(p_by_carrier)</span>
<span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Hydro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Small Hydro&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Hydro&#39;</span><span class="p">]</span>
<span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Oil&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">p_by_carrier</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Small Hydro&#39;</span><span class="p">,</span> <span class="s1">&#39;Anaerobic Digestion&#39;</span><span class="p">,</span> <span class="s1">&#39;Biomass (co-firing)&#39;</span><span class="p">,</span> <span class="s1">&#39;Biomass (dedicated)&#39;</span><span class="p">,</span> <span class="s1">&#39;Landfill Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Sewage Sludge Digestion&#39;</span><span class="p">,</span> <span class="s1">&#39;Shoreline Wave&#39;</span><span class="p">,</span> <span class="s1">&#39;Tidal Barrage and Tidal Stream&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p_by_carrier</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
carrier
Coal                              3.041580
EfW Incineration                  3.474006
Interconnectors Import           21.929185
Hydro                             2.988822
Natural Gas                     139.369596
Nuclear                          59.480659
Oil                               0.000000
Solar Photovoltaics              14.709476
Wind Offshore                    26.039234
Wind Onshore                     29.114726
Pumped Storage Hydroelectric      0.444488
Biomass                          30.997990
dtype: float64
</pre></div></div>
</div>
<p>Then the total of all simulated power generation is:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_by_carrier</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
331.5897624571445
</pre></div></div>
</div>
<p>BEIS publish reports on power generation, and here we extract the data for 2018 from X and Y <a class="reference external" href="https://www.gov.uk/government/statistics/energy-trends-section-6-renewables">https://www.gov.uk/government/statistics/energy-trends-section-6-renewables</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Coal&#39;</span><span class="p">:</span> <span class="mf">16.0</span><span class="p">,</span>
        <span class="s1">&#39;EfW Incineration&#39;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">,</span>
        <span class="s1">&#39;Interconnectors Import&#39;</span><span class="p">:</span> <span class="mf">21.9</span><span class="p">,</span>
        <span class="s1">&#39;Hydro&#39;</span><span class="p">:</span> <span class="mf">5.4</span><span class="p">,</span>
        <span class="s1">&#39;Natural Gas&#39;</span><span class="p">:</span> <span class="mf">129.1</span><span class="p">,</span>
        <span class="s1">&#39;Nuclear&#39;</span><span class="p">:</span> <span class="mf">59.1</span><span class="p">,</span>
        <span class="s1">&#39;Oil&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s1">&#39;Solar Photovoltaics&#39;</span><span class="p">:</span> <span class="mf">12.7</span><span class="p">,</span>
        <span class="s1">&#39;Wind Offshore&#39;</span><span class="p">:</span> <span class="mf">26.5</span><span class="p">,</span>
        <span class="s1">&#39;Wind Onshore&#39;</span><span class="p">:</span> <span class="mf">30.4</span><span class="p">,</span>
        <span class="s1">&#39;Pumped Storage Hydroelectric&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;Biomass&#39;</span><span class="p">:</span> <span class="mf">31.5</span>
        <span class="p">}</span>
<span class="n">data_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">data_series</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Coal                             16.0
EfW Incineration                  3.5
Interconnectors Import           21.9
Hydro                             5.4
Natural Gas                     129.1
Nuclear                          59.1
Oil                               1.0
Solar Photovoltaics              12.7
Wind Offshore                    26.5
Wind Onshore                     30.4
Pumped Storage Hydroelectric      0.0
Biomass                          31.5
dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_series</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
337.09999999999997
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_series</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;Coal&#39;, &#39;EfW Incineration&#39;, &#39;Interconnectors Import&#39;, &#39;Hydro&#39;,
       &#39;Natural Gas&#39;, &#39;Nuclear&#39;, &#39;Oil&#39;, &#39;Solar Photovoltaics&#39;, &#39;Wind Offshore&#39;,
       &#39;Wind Onshore&#39;, &#39;Pumped Storage Hydroelectric&#39;, &#39;Biomass&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mylabels = data_series.index</span>
<span class="c1"># mycolors = categorical_cmap(3, 10)</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Coal&quot;</span><span class="p">:</span> <span class="s2">&quot;grey&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Diesel/Gas oil&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Diesel/gas Diesel/Gas oil&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
          <span class="s1">&#39;Oil&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Anaerobic Digestion&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;EfW Incineration&#39;</span><span class="p">:</span> <span class="s1">&#39;chocolate&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Sewage Sludge Digestion&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Landfill Gas&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Biomass (dedicated)&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Biomass (co-firing)&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Biomass&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Interconnectors Import&#39;</span><span class="p">:</span> <span class="s1">&#39;pink&#39;</span><span class="p">,</span>
          <span class="s2">&quot;Sour gas&quot;</span><span class="p">:</span> <span class="s2">&quot;lightcoral&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Natural Gas&quot;</span><span class="p">:</span> <span class="s2">&quot;lightcoral&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Nuclear&quot;</span><span class="p">:</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
          <span class="s1">&#39;Shoreline Wave&#39;</span><span class="p">:</span> <span class="s1">&#39;aqua&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Tidal Barrage and Tidal Stream&#39;</span><span class="p">:</span> <span class="s1">&#39;aqua&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Hydro&#39;</span><span class="p">:</span> <span class="s2">&quot;turquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Large Hydro&quot;</span><span class="p">:</span> <span class="s2">&quot;turquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Small Hydro&quot;</span><span class="p">:</span> <span class="s2">&quot;turquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Pumped Storage Hydroelectric&quot;</span><span class="p">:</span> <span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Wind Offshore&quot;</span><span class="p">:</span> <span class="s2">&quot;lightskyblue&quot;</span><span class="p">,</span>
          <span class="s1">&#39;Wind Onshore&#39;</span><span class="p">:</span> <span class="s1">&#39;deepskyblue&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Solar Photovoltaics&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">data_series</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_series</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">p_by_carrier</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%1.1f%%</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">pctdistance</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">labeldistance</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Historical data&#39;</span><span class="p">)</span>

<span class="n">simulated_generation</span> <span class="o">=</span> <span class="n">p_by_carrier</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">simulated_generation</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">simulated_generation</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">p_by_carrier</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%1.1f%%</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">pctdistance</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">labeldistance</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Simulated data&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_9_-_Comparison_To_Historical_Data_29_0.png" src="../_images/notebooks_9_-_Comparison_To_Historical_Data_29_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">simulated_generation</span><span class="p">,</span> <span class="n">data_series</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Simulated&#39;</span><span class="p">,</span> <span class="s1">&#39;Historical&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated - Historical&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Historical&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated (%)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Historical (%)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Historical&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Historical&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated (%) - Historical (%)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated (%)&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Historical (%)&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Simulated</th>
      <th>Historical</th>
      <th>Simulated - Historical</th>
      <th>Simulated (%)</th>
      <th>Historical (%)</th>
      <th>Simulated (%) - Historical (%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Coal</th>
      <td>3.0</td>
      <td>16.0</td>
      <td>-13.0</td>
      <td>0.9</td>
      <td>4.7</td>
      <td>-3.8</td>
    </tr>
    <tr>
      <th>EfW Incineration</th>
      <td>3.5</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>1.1</td>
      <td>1.0</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>Interconnectors Import</th>
      <td>21.9</td>
      <td>21.9</td>
      <td>0.0</td>
      <td>6.6</td>
      <td>6.5</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>Hydro</th>
      <td>3.0</td>
      <td>5.4</td>
      <td>-2.4</td>
      <td>0.9</td>
      <td>1.6</td>
      <td>-0.7</td>
    </tr>
    <tr>
      <th>Natural Gas</th>
      <td>139.4</td>
      <td>129.1</td>
      <td>10.3</td>
      <td>42.1</td>
      <td>38.3</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>Nuclear</th>
      <td>59.5</td>
      <td>59.1</td>
      <td>0.4</td>
      <td>17.9</td>
      <td>17.5</td>
      <td>0.4</td>
    </tr>
    <tr>
      <th>Oil</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>-1.0</td>
      <td>0.0</td>
      <td>0.3</td>
      <td>-0.3</td>
    </tr>
    <tr>
      <th>Solar Photovoltaics</th>
      <td>14.7</td>
      <td>12.7</td>
      <td>2.0</td>
      <td>4.4</td>
      <td>3.8</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>Wind Offshore</th>
      <td>26.0</td>
      <td>26.5</td>
      <td>-0.5</td>
      <td>7.8</td>
      <td>7.9</td>
      <td>-0.1</td>
    </tr>
    <tr>
      <th>Wind Onshore</th>
      <td>29.1</td>
      <td>30.4</td>
      <td>-1.3</td>
      <td>8.8</td>
      <td>9.0</td>
      <td>-0.2</td>
    </tr>
    <tr>
      <th>Pumped Storage Hydroelectric</th>
      <td>0.4</td>
      <td>0.0</td>
      <td>0.4</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>Biomass</th>
      <td>31.0</td>
      <td>31.5</td>
      <td>-0.5</td>
      <td>9.4</td>
      <td>9.3</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>Total</th>
      <td>331.5</td>
      <td>337.1</td>
      <td>-5.6</td>
      <td>100.0</td>
      <td>99.9</td>
      <td>0.1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Looking at table above we can see - Gas too high - Coal too low</p>
<p>Likely due to price dynamics of gas and coal which are not fully captured in marginal cost.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="6%20-%20Unit%20Commitment.html" class="btn btn-neutral float-left" title="Unit Commitment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="7%20-%20Network%20Expansion.html" class="btn btn-neutral float-right" title="Network Expansion" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Andrew Lyden.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>